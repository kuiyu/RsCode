import{_ as s,c as i,o as t,a4 as a}from"./chunks/framework.CI8or701.js";const c=JSON.parse('{"title":"PetaPoco说明","description":"RsCode中对PetaPoco的说明","frontmatter":{"home":false,"editLink":false,"lang":"zh-CN","title":"PetaPoco说明","description":"RsCode中对PetaPoco的说明"},"headers":[],"relativePath":"rscode/db/petapoco.md","filePath":"rscode/db/petapoco.md","lastUpdated":1713227600000}'),e={name:"rscode/db/petapoco.md"},l=a(`<p>可从Nuget下载，所使用的数据库驱动</p><p>PetaPoco支持的数据库有</p><table><thead><tr><th>数据库驱动类名称</th><th style="text-align:center;">支持的数据库驱动</th><th style="text-align:right;">Other</th></tr></thead><tbody><tr><td>SqlServerDatabaseProvider</td><td style="text-align:center;">SqlServer, System.Data.SqlClient</td><td style="text-align:right;">Is the default</td></tr><tr><td>MySqlDatabaseProvider</td><td style="text-align:center;">MySql,MySql.Data.MySqlClient</td><td style="text-align:right;"></td></tr><tr><td>MariaDbDatabaseProvider</td><td style="text-align:center;">MariaDb</td><td style="text-align:right;">May use MySql provider</td></tr><tr><td>PostgreSQLDatabaseProvider</td><td style="text-align:center;">Npgsql, pgsql</td><td style="text-align:right;"></td></tr><tr><td>SQLiteDatabaseProvider</td><td style="text-align:center;">SQLite, System.Data.SQLite</td><td style="text-align:right;"></td></tr><tr><td>SqlServerCEDatabaseProviders</td><td style="text-align:center;">SqlServerCe, SqlCeConnection, System.Data.SqlServerCe.4.0</td><td style="text-align:right;"></td></tr><tr><td>OracleDatabaseProvider</td><td style="text-align:center;">Oracle, Oracle.ManagedDataAccess.Client</td><td style="text-align:right;"></td></tr><tr><td>MsAccessDbDatabaseProvider</td><td style="text-align:center;">OLEDB</td><td style="text-align:right;">Connection string must have either Microsoft.ACE.OLEDB.12.0 or Microsoft.Jet.OLEDB.4.0</td></tr><tr><td>FirebirdDbDatabaseProvider</td><td style="text-align:center;">Firebird, FbConnection</td><td style="text-align:right;">beta</td></tr></tbody></table><p>用到哪个就去Nuget上搜</p><p>RsCode使用PetaPoco做为ORM,<a href="https://github.com/CollaboratingPlatypus/PetaPoco/wiki/Quick-Start" target="_blank" rel="noreferrer">官方文档</a></p><p>Petapoco默认使用的数据库是mssql,<a href="https://github.com/CollaboratingPlatypus/PetaPoco/wiki/Connection-string-provider-names" target="_blank" rel="noreferrer">文档</a></p><p>//插入操作<a href="https://github.com/CollaboratingPlatypus/PetaPoco/wiki/Inserting" target="_blank" rel="noreferrer">https://github.com/CollaboratingPlatypus/PetaPoco/wiki/Inserting</a></p><p>//事务操作<a href="https://github.com/CollaboratingPlatypus/PetaPoco/wiki/Transactions" target="_blank" rel="noreferrer">https://github.com/CollaboratingPlatypus/PetaPoco/wiki/Transactions</a></p><p>//存储过程<a href="https://github.com/CollaboratingPlatypus/PetaPoco/wiki/Stored-procedures" target="_blank" rel="noreferrer">https://github.com/CollaboratingPlatypus/PetaPoco/wiki/Stored-procedures</a></p><p>//1对多,多对1 <a href="https://github.com/CollaboratingPlatypus/PetaPoco/wiki/Multi-Poco-Queries" target="_blank" rel="noreferrer">https://github.com/CollaboratingPlatypus/PetaPoco/wiki/Multi-Poco-Queries</a></p><p>注意事项：</p><p>Petapoco 类模型的定义</p><div class="language-csharp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">csharp</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> RoleInfo</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {      </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; }     </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> string</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> RoleName</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; }      </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> string</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Remark</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span></code></pre></div><p>默认类名就是表名，默认主键是Id ,默认自增长</p><p>如果更换了默认值,要用ableName PrimaryKey声明</p><div class="language-csharp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">csharp</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TableName</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;rswl_role_info&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">PrimaryKey</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> RoleInfo</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Column</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> RoleId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span></code></pre></div><p>类的映射</p><p>默认情况下不需要映射。假设表名将是类名，如果未使用下面的属性指定主键，则主键为&#39;Id&#39;。</p><p>基本映射是通过属性完成的。最常用的是：</p><p>[TableName] 这需要一个“name”参数，它指示Poco类将被映射到的表。</p><p>[PrimaryKey] 这有一个“columnName”参数，它使用表的主键的列名称。多个主键可以通过用逗号分隔列来指定。还有一个“autoIncrement”属性，用于指示主键列是否自动增加，例如Sql Server中的标识列。默认情况下是这样。对于Oracle，还有一个“sequenceName”属性，在使用Oracle插入数据时将使用该属性。</p><p>[Column] 如果列名称与属性名称不匹配，则使用此名称。</p><p>[Ignore] 该属性将被忽略，不能映射到。</p><p>[ResultColumn] 标有结果列的属性可以映射到，但是这些属性不会包含在插入或更新中。注意：这些列需要在SQL中显式指定。它不会被包含在自动生成的SQL中。</p><p>[ComputedColumn] “ComputedColumn”列属性的属性与“ResultColumn”列属性的工作方式相同，但是它们将在SQL中自动选择。</p><h4 id="查询多个结果" tabindex="-1">查询多个结果 <a class="header-anchor" href="#查询多个结果" aria-label="Permalink to &quot;查询多个结果&quot;">​</a></h4><div class="language-csharp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">csharp</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">var</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> result</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">db.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">QueryMultiple</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sql))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    var</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> user</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">result.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Read</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">User</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    var</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> address</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">result.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Read</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Address</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>1对多查询,多对一查询 <a href="https://github.com/CollaboratingPlatypus/PetaPoco/wiki/Mapping-One-to-Many-and-Many-to-One-Relationships" target="_blank" rel="noreferrer">https://github.com/CollaboratingPlatypus/PetaPoco/wiki/Mapping-One-to-Many-and-Many-to-One-Relationships</a></p><p>分页查询 带上order by 会更快</p>`,29),n=[l];function p(h,r,k,d,o,g){return t(),i("div",null,n)}const y=s(e,[["render",p]]);export{c as __pageData,y as default};
